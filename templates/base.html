<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% block title %}Prompt Template Manager{% endblock %}</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        .template-card {
            transition: transform 0.2s;
        }
        .template-card:hover {
            transform: translateY(-2px);
        }
        .variable-tag {
            background-color: #e3f2fd;
            color: #1976d2;
            padding: 2px 6px;
            border-radius: 4px;
            font-size: 0.8em;
            margin-right: 4px;
        }
    </style>
</head>
<body>
    <nav class="navbar navbar-expand-lg navbar-dark bg-primary">
        <div class="container">
            <a class="navbar-brand" href="{{ url_for('index') }}">üìù Prompt Templates</a>
            <div class="navbar-nav ms-auto">
                <a class="nav-link" href="{{ url_for('create_template') }}">+ New Template</a>
            </div>
        </div>
    </nav>

    <div class="container mt-4">
        {% block content %}{% endblock %}
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
    {% block scripts %}{% endblock %}
</body>
</html>

# templates/index.html
{% extends "base.html" %}

{% block content %}
<div class="row mb-4">
    <div class="col-md-8">
        <h1>Prompt Templates</h1>
        <p class="text-muted">Manage and query your AI prompt templates</p>
    </div>
    <div class="col-md-4">
        <div class="d-grid">
            <a href="{{ url_for('create_template') }}" class="btn btn-primary">Create New Template</a>
        </div>
    </div>
</div>

<div class="row mb-3">
    <div class="col-md-6">
        <input type="text" id="searchInput" class="form-control" placeholder="Search templates...">
    </div>
    <div class="col-md-3">
        <select id="categoryFilter" class="form-select">
            <option value="">All Categories</option>
            {% for category in categories %}
            <option value="{{ category }}">{{ category }}</option>
            {% endfor %}
        </select>
    </div>
    <div class="col-md-3">
        <input type="text" id="tagFilter" class="form-control" placeholder="Filter by tag...">
    </div>
</div>

<div id="templatesList" class="row">
    {% for template in templates %}
    <div class="col-md-6 col-lg-4 mb-3 template-item" 
         data-category="{{ template.category }}" 
         data-tags="{{ template.tags|join(',') }}">
        <div class="card template-card h-100">
            <div class="card-body">
                <h5 class="card-title">{{ template.name }}</h5>
                <p class="card-text text-muted">{{ template.description[:100] }}{% if template.description|length > 100 %}...{% endif %}</p>
                <div class="mb-2">
                    <span class="badge bg-secondary">{{ template.category }}</span>
                    <small class="text-muted ms-2">Used {{ template.usage_count }} times</small>
                </div>
                {% if template.variables %}
                <div class="mb-2">
                    <small class="text-muted">Variables:</small><br>
                    {% for var in template.variables %}
                    <span class="variable-tag">{{ var }}</span>
                    {% endfor %}
                </div>
                {% endif %}
                {% if template.tags %}
                <div class="mb-2">
                    {% for tag in template.tags %}
                    <span class="badge bg-light text-dark me-1">{{ tag }}</span>
                    {% endfor %}
                </div>
                {% endif %}
            </div>
            <div class="card-footer bg-transparent">
                <a href="{{ url_for('view_template', template_id=template.key.id()) }}" class="btn btn-sm btn-outline-primary">View</a>
                <a href="{{ url_for('edit_template', template_id=template.key.id()) }}" class="btn btn-sm btn-outline-secondary">Edit</a>
                <button class="btn btn-sm btn-outline-danger" onclick="deleteTemplate({{ template.key.id() }})">Delete</button>
            </div>
        </div>
    </div>
    {% endfor %}
</div>

{% if not templates %}
<div class="text-center mt-5">
    <h3 class="text-muted">No templates yet</h3>
    <p>Create your first prompt template to get started!</p>
    <a href="{{ url_for('create_template') }}" class="btn btn-primary">Create Template</a>
</div>
{% endif %}
{% endblock %}

{% block scripts %}
<script>
document.getElementById('searchInput').addEventListener('input', filterTemplates);
document.getElementById('categoryFilter').addEventListener('change', filterTemplates);
document.getElementById('tagFilter').addEventListener('input', filterTemplates);

function filterTemplates() {
    const searchTerm = document.getElementById('searchInput').value.toLowerCase();
    const category = document.getElementById('categoryFilter').value;
    const tag = document.getElementById('tagFilter').value.toLowerCase();
    
    const templates = document.querySelectorAll('.template-item');
    
    templates.forEach(template => {
        const title = template.querySelector('.card-title').textContent.toLowerCase();
        const description = template.querySelector('.card-text').textContent.toLowerCase();
        const templateCategory = template.dataset.category;
        const templateTags = template.dataset.tags.toLowerCase();
        
        const matchesSearch = !searchTerm || title.includes(searchTerm) || description.includes(searchTerm);
        const matchesCategory = !category || templateCategory === category;
        const matchesTag = !tag || templateTags.includes(tag);
        
        if (matchesSearch && matchesCategory && matchesTag) {
            template.style.display = 'block';
        } else {
            template.style.display = 'none';
        }
    });
}

function deleteTemplate(templateId) {
    if (confirm('Are you sure you want to delete this template?')) {
        const form = document.createElement('form');
        form.method = 'POST';
        form.action = `/delete/${templateId}`;
        document.body.appendChild(form);
        form.submit();
    }
}
</script>
{% endblock %}
